(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-64e9e438"],{"2fab":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"page-user-list"}},[a("vx-card",{ref:"filterCard",staticClass:"user-list-filters mb-8",attrs:{title:"条件搜索",actionButtons:""},on:{refresh:t.resetColFilters,remove:t.resetColFilters}},[a("div",{staticClass:"vx-row"},[a("div",{staticClass:"vx-col md:w-1/4 sm:w-1/2 w-full"},[a("label",{staticClass:"text-sm opacity-75"},[t._v("状态")]),a("v-select",{staticClass:"mb-4 md:mb-0",attrs:{options:t.statusOptions,clearable:!1,dir:t.$vs.rtl?"rtl":"ltr"},model:{value:t.roleFilter,callback:function(e){t.roleFilter=e},expression:"roleFilter"}})],1),a("div",{staticClass:"vx-col md:w-1/4 sm:w-1/2 w-full"},[a("label",{staticClass:"text-sm opacity-75"},[t._v("起始时间")]),a("vs-input",{staticClass:"mt-5 w-full define",attrs:{type:"date"},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.onSubmit(e)}},model:{value:t.startTime,callback:function(e){t.startTime=e},expression:"startTime"}})],1),a("div",{staticClass:"vx-col md:w-1/4 sm:w-1/2 w-full"},[a("label",{staticClass:"text-sm opacity-75"},[t._v("截至时间")]),a("vs-input",{staticClass:"mt-5 w-full define",attrs:{type:"date"},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.onSubmit(e)}},model:{value:t.endTime,callback:function(e){t.endTime=e},expression:"endTime"}})],1),a("div",{staticClass:"vx-col md:w-1/4 sm:w-1/2 w-full"},[a("vs-button",{staticClass:"search",on:{click:t.search}},[t._v("搜索")]),a("vs-button",{staticClass:"search",on:{click:t.clear}},[t._v("清空")])],1)])]),a("div",{staticClass:"vx-card p-6"},[a("div",{staticClass:"flex flex-wrap items-center"},[a("div",{staticClass:"flex-grow"},[a("vs-dropdown",{staticClass:"cursor-pointer",attrs:{"vs-trigger-click":""}},[a("div",{staticClass:"p-4 border border-solid d-theme-border-grey-light rounded-full d-theme-dark-bg cursor-pointer flex items-center justify-between font-medium"},[a("span",{staticClass:"mr-2"},[t._v(t._s(t.currentPage*t.pageSize-(t.pageSize-1))+" - "+t._s(t.currentPage*t.pageSize)+" of "+t._s(t.total))]),a("feather-icon",{attrs:{icon:"ChevronDownIcon",svgClasses:"h-4 w-4"}})],1),a("vs-dropdown-menu",[a("vs-dropdown-item",{on:{click:function(e){t.pageSize=10}}},[a("span",[t._v("10")])]),a("vs-dropdown-item",{on:{click:function(e){t.pageSize=20}}},[a("span",[t._v("20")])]),a("vs-dropdown-item",{on:{click:function(e){t.pageSize=30}}},[a("span",[t._v("30")])]),a("vs-dropdown-item",{on:{click:function(e){t.pageSize=50}}},[a("span",[t._v("50")])])],1)],1)],1),a("div",{},[a("vs-button",{staticClass:"search",attrs:{type:"border"},on:{click:t.addNewData}},[t._v("添加")])],1)]),a("ag-grid-vue",{ref:"agGridTable",staticClass:"ag-theme-material w-100 my-4 ag-grid-table",attrs:{components:t.components,gridOptions:t.gridOptions,columnDefs:t.columnDefs,defaultColDef:t.defaultColDef,rowData:t.list,rowSelection:"multiple",colResizeDefault:"shift",animateRows:!0,floatingFilter:!1,pagination:!0,pageSize:t.pageSize,suppressPaginationPanel:!0,enableRtl:t.$vs.rtl}}),a("vs-pagination",{attrs:{total:t.totalPages,max:7},model:{value:t.currentPage,callback:function(e){t.currentPage=e},expression:"currentPage"}})],1),a("cell-editer",{attrs:{data:t.editerData,isSidebarActive:t.sidebarActive},on:{closeSidebar:t.closeSider,reload:t.getEenvelopeList}})],1)},s=[],n=(a("b06f"),a("aaa4"),a("bd58")),r=(a("4e06"),a("aab0")),l=a.n(r),o=a("4faa"),c=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{style:{direction:t.$vs.rtl?"rtl":"ltr"}},[a("feather-icon",{attrs:{icon:"Edit3Icon",svgClasses:"h-5 w-5 mr-4 hover:text-primary cursor-pointer"},on:{click:function(e){return t.toEdit(t.params.data)}}}),a("feather-icon",{attrs:{icon:"Trash2Icon",svgClasses:"h-5 w-5 hover:text-danger cursor-pointer"},on:{click:function(e){return t.del(t.params)}}})],1)},d=[],u={name:"CellRendererActions",data:{return:function(){}},methods:{toEdit:function(t){this.$parent.$parent.editerData=t,console.log(this.$parent.$parent),this.$parent.$parent.sidebarActive=!0},editRecord:function(){this.$router.push("/apps/user/user-edit/".concat(268)).catch((function(){}))},confirmDeleteRecord:function(){this.$vs.dialog({type:"confirm",color:"danger",title:"Confirm Delete",text:'You are about to delete "'.concat(this.params.data.username,'"'),accept:this.deleteRecord,acceptText:"Delete"})},del:function(t){var e=this;e.del_id=t.data.id,this.$vs.dialog({type:"confirm",title:"提示",text:"确定删除？",accept:e.delEnvelope,cancel:e.cancel,acceptText:"确定",cancelText:"取消"})},delEnvelope:function(){console.log(1111);var t=this;t.$axios({url:"/admin/Activity/delEnvelope",method:"post",data:{id:t.del_id}}).then((function(e){1==e.data.status?(t.notify(e.data.msg,"success"),console.log(t.$parent.$parent),t.$parent.$parent.getEenvelopeList()):t.notify(e.data.msg,"danger")}))},notify:function(t,e){var a=this;a.$vs.notify({title:"提示",text:t,iconPack:"feather",icon:"icon-alert-circle",color:e})},deleteRecord:function(){this.showDeleteSuccess()},showDeleteSuccess:function(){this.$vs.notify({color:"success",title:"User Deleted",text:"The selected user was successfully deleted"})}}},m=u,f=a("5d22"),p=Object(f["a"])(m,c,d,!1,null,null,null),h=p.exports,v=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("vs-sidebar",{staticClass:"add-new-data-sidebar items-no-padding",attrs:{"click-not-close":"","position-right":"",parent:"body","default-index":"1",color:"primary",spacer:""},model:{value:t.isSidebarActiveLocal,callback:function(e){t.isSidebarActiveLocal=e},expression:"isSidebarActiveLocal"}},[a("div",{staticClass:"mt-6 flex items-center justify-between px-6"},[a("h4",[t._v("\n      "+t._s(0===Object.entries(this.data).length?"添加":"编辑")+" 红包\n    ")]),a("feather-icon",{staticClass:"cursor-pointer",attrs:{icon:"XIcon"},on:{click:function(e){e.stopPropagation(),t.isSidebarActiveLocal=!1}}})],1),a(t.scrollbarTag,{key:t.$vs.rtl,tag:"component",staticClass:"scroll-area--data-list-add-new",attrs:{settings:t.settings}},[a("div",{staticClass:"p-6"},[a("vs-input",{staticClass:"mt-5 w-full",attrs:{label:"红包名称",name:"item-name"},model:{value:t.edtiterData.name,callback:function(e){t.$set(t.edtiterData,"name",e)},expression:"edtiterData.name"}}),a("vs-input",{staticClass:"mt-5 w-full",attrs:{label:"金额",name:"item-money"},model:{value:t.edtiterData.money,callback:function(e){t.$set(t.edtiterData,"money",e)},expression:"edtiterData.money"}}),a("span",{directives:[{name:"show",rawName:"v-show",value:t.errors.has("item-money"),expression:"errors.has('item-money')"}],staticClass:"text-danger text-sm"},[t._v(t._s(t.errors.first("item-money")))]),a("vs-input",{staticClass:"mt-5 w-full",attrs:{label:"红包个数",name:"item-total_num"},model:{value:t.edtiterData.total_num,callback:function(e){t.$set(t.edtiterData,"total_num",e)},expression:"edtiterData.total_num"}}),a("vs-input",{staticClass:"mt-5 w-full",attrs:{label:"口令",name:"item-pass"},model:{value:t.edtiterData.pass,callback:function(e){t.$set(t.edtiterData,"pass",e)},expression:"edtiterData.pass"}}),a("vs-select",{staticClass:"mt-4 w-full",attrs:{label:"类型"},model:{value:t.edtiterData.type,callback:function(e){t.$set(t.edtiterData,"type",e)},expression:"edtiterData.type"}},t._l(t.typeOptions,(function(t,e){return a("vs-select-item",{key:e,attrs:{value:t.value,text:t.label}})})),1)],1)]),a("div",{staticClass:"flex flex-wrap items-center p-6",attrs:{slot:"footer"},slot:"footer"},[a("vs-button",{staticClass:"mr-6",on:{click:t.submitData}},[t._v("提交")]),a("vs-button",{attrs:{type:"border",color:"danger"},on:{click:function(e){t.isSidebarActiveLocal=!1}}},[t._v("取消")])],1)],1)},g=[],b=(a("3a23"),a("612f"),a("bd70"),a("c322")),y=a.n(b),w={props:{isSidebarActive:{type:Boolean,required:!0},data:{type:Object,default:function(){}}},components:{VuePerfectScrollbar:y.a},data:function(){return{edtiterData:{dataId:null,type:"",money:"",name:"",total_num:"",pass:""},settings:{maxScrollbarLength:60,wheelSpeed:.6},typeOptions:[{label:"随机",value:"1"},{label:"平分",value:"2"}]}},watch:{isSidebarActive:function(t){if(t)if(console.log(this.data),0===Object.entries(this.data).length)this.initValues();else{var e=JSON.parse(JSON.stringify(this.data)),a=e.id,i=e.money,s=e.name,n=e.total_num,r=e.pass,l=e.type;this.edtiterData.dataId=a,this.edtiterData.money=i,this.edtiterData.name=s,this.edtiterData.total_num=n,this.edtiterData.pass=r,this.edtiterData.type=l}}},computed:{isSidebarActiveLocal:{get:function(){return this.isSidebarActive},set:function(t){t||(this.$emit("closeSidebar"),this.initValues())}},isFormValid:function(){return!this.errors.any()&&this.type_name},scrollbarTag:function(){return this.$store.getters.scrollbarTag}},methods:{initValues:function(){this.data.id||(this.edtiterData.dataId="",this.edtiterData.money="",this.edtiterData.name="",this.edtiterData.total_num="",this.edtiterData.pass="",this.edtiterData.type="")},submitData:function(){var t=this,e=this,a="/admin/Activity/addEnvelope";this.edtiterData.dataId>0?a="/admin/Activity/editEnvelope":delete this.edtiterData.dataId,e.$axios({url:a,method:"post",data:e.edtiterData}).then((function(a){1==a.data.status?(e.$vs.notify({title:"提示",text:a.data.msg,iconPack:"feather",icon:"icon-alert-circle",color:"success"}),t.$emit("closeSidebar"),t.$emit("reload"),t.initValues()):e.$vs.notify({title:"提示",text:a.data.msg,iconPack:"feather",icon:"icon-alert-circle",color:"danger"})}))},updateCurrImg:function(t){var e=this;if(t.target.files&&t.target.files[0]){var a=new FileReader;a.onload=function(t){e.dataImg=t.target.result},a.readAsDataURL(t.target.files[0]),this.file=t.target.files[0]}}}},C=w,x=(a("a3c8"),Object(f["a"])(C,v,g,!1,null,"a79ce94a",null)),D=x.exports,S={components:{AgGridVue:n["AgGridVue"],vSelect:l.a,CellOperate:h,CellEditer:D},data:function(){return{searchQuery:"",roleFilter:{label:"所有",value:""},statusOptions:[{label:"所有",value:""},{label:"已抢完",value:"2"},{label:"未抢完",value:"1"}],startTime:"",endTime:"",list:[],gridApi:null,gridOptions:{},defaultColDef:{sortable:!0,resizable:!0,suppressMenu:!0},columnDefs:[{headerName:"名称",field:"name",width:150,filter:!0},{headerName:"金额",field:"money",width:150,filter:!0},{headerName:"剩余",field:"balance",width:125,filter:!0},{headerName:"总数",field:"total_num",filter:!0,width:125},{headerName:"已领",field:"num",filter:!0,width:125},{headerName:"类型",field:"typeStr",filter:!0,width:125},{headerName:"状态",field:"statusStr",filter:!0,width:125},{headerName:"时间",field:"create_time",filter:!0,width:180},{headerName:"操作",field:"transactions",width:150,cellRendererFramework:"CellOperate"}],components:{CellOperate:h},currentPage:1,pageSize:10,totalPages:0,total:0,status:"",editerData:{},sidebarActive:!1}},watch:{roleFilter:function(t){this.setColumnFilter("role",t.value)},statusFilter:function(t){this.setColumnFilter("status",t.value)},isVerifiedFilter:function(t){var e="all"===t.value?"all":"yes"===t.value?"true":"false";this.setColumnFilter("is_verified",e)},departmentFilter:function(t){this.setColumnFilter("department",t.value)},pageSize:function(){this.getEenvelopeList()},currentPage:function(){this.getEenvelopeList()}},computed:{},methods:{getEenvelopeList:function(){var t=this;t.startTime&&t.endTime&&t.startTime>t.endTime?t.$vs.notify({color:"danger",title:"提示",text:"时间筛选有误"}):t.$axios({url:"/admin/Activity/envelopeList",method:"post",data:{page:t.currentPage,pageSize:t.pageSize,status:t.status,startTime:t.startTime,endTime:t.endTime}}).then((function(e){console.log(e),1==e.data.status?(t.list=e.data.data.list,t.total=e.data.data.total,t.totalPages=t.pageTotal(t.total,t.pageSize)):(t.list=[],t.total=0,t.totalPages=1)}))},addNewData:function(){this.sidebarActive=!0,this.editerData={}},closeSider:function(){this.sidebarActive=!1},search:function(){this.status=this.roleFilter.value,this.getEenvelopeList()},onSubmit:function(){this.search()},clear:function(){""==this.startTime&&""==this.endTime&&""==this.status||(this.startTime="",this.endTime="",this.status="",this.roleFilter={label:"所有",value:""},this.getEenvelopeList())},pageTotal:function(t,e){return null==t||""==t?0:0!=e&&t%e==0?parseInt(t/e):0!=e&&t%e!=0?parseInt(t/e)+1:void 0},setColumnFilter:function(t,e){this.status=e,this.getEenvelopeList()},resetColFilters:function(){this.gridApi.setFilterModel(null),this.gridApi.onFilterChanged(),this.roleFilter=this.statusFilter=this.isVerifiedFilter=this.departmentFilter={label:"All",value:"all"},this.$refs.filterCard.removeRefreshAnimation()},updateSearchQuery:function(t){this.gridApi.setQuickFilter(t)}},mounted:function(){if(this.gridApi=this.gridOptions.api,this.getEenvelopeList(),this.$vs.rtl){var t=this.$refs.agGridTable.$el.querySelector(".ag-header-container");t.style.left="-".concat(String(Number(t.style.transform.slice(11,-3))+9),"px")}},created:function(){o["a"].isRegistered||(this.$store.registerModule("userManagement",o["a"]),o["a"].isRegistered=!0),this.$store.dispatch("userManagement/fetchUsers").catch((function(t){console.error(t)}))}},_=S,k=(a("4982"),Object(f["a"])(_,i,s,!1,null,null,null));e["default"]=k.exports},4982:function(t,e,a){"use strict";a("d9f7")},"4faa":function(t,e,a){"use strict";var i={users:[]},s=(a("a1d1"),{SET_USERS:function(t,e){t.users=e},REMOVE_RECORD:function(t,e){var a=t.users.findIndex((function(t){return t.id===e}));t.users.splice(a,1)}}),n=a("bb36"),r={fetchUsers:function(t){var e=t.commit;return new Promise((function(t,a){n["a"].get("/api/user-management/users").then((function(a){e("SET_USERS",a.data),t(a)})).catch((function(t){a(t)}))}))},fetchUser:function(t,e){return new Promise((function(t,a){n["a"].get("/api/user-management/users/".concat(e)).then((function(e){t(e)})).catch((function(t){a(t)}))}))},removeRecord:function(t,e){var a=t.commit;return new Promise((function(t,i){n["a"].delete("/api/user-management/users/".concat(e)).then((function(i){a("REMOVE_RECORD",e),t(i)})).catch((function(t){i(t)}))}))}},l={};e["a"]={isRegistered:!1,namespaced:!0,state:i,mutations:s,actions:r,getters:l}},"70b9":function(t,e,a){},a3c8:function(t,e,a){"use strict";a("70b9")},d9f7:function(t,e,a){}}]);
//# sourceMappingURL=chunk-64e9e438.f16194e9.js.map