(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-74c62971"],{"1be2":function(t,e,a){},"1dc4":function(t,e,a){"use strict";a("1be2")},5787:function(t,e,a){"use strict";a("6813")},6813:function(t,e,a){},b616:function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"data-list-container",attrs:{id:"data-list-thumb-view"}},[a("data-view-sidebar",{attrs:{isSidebarActive:t.addNewDataSidebar,data:t.sidebarData},on:{closeSidebar:t.toggleDataSidebar,get:t.getRoomList}}),a("div",{staticClass:"flex flex-wrap-reverse items-center flex-grow justify-between",attrs:{slot:"header"},slot:"header"},[a("div",{staticClass:"flex flex-wrap-reverse items-center"},[a("div",{staticClass:"p-3 mb-4 mr-4 rounded-lg cursor-pointer flex items-center justify-between text-lg font-medium text-base text-primary border border-solid border-primary",on:{click:t.addNewData}},[a("feather-icon",{attrs:{icon:"PlusIcon",svgClasses:"h-4 w-4"}}),a("span",{staticClass:"ml-2 text-base text-primary"},[t._v("添加房间")])],1)])]),a("vs-table",{ref:"table",attrs:{"max-items":t.itemsPerPage,data:t.data},scopedSlots:t._u([{key:"default",fn:function(e){var o=e.data;return[a("tbody",t._l(o,(function(e,o){return a("vs-tr",{key:o,attrs:{data:e}},[a("vs-td",{staticClass:"img-container"},[a("img",{staticClass:"product-img",attrs:{src:e.img}})]),a("vs-td",[a("p",{staticClass:"product-name font-medium truncate",on:{click:function(a){return t.editNewData(e)}}},[t._v(t._s(e.room_name))])]),a("vs-td",[a("p",{staticClass:"product-category"},[t._v(t._s(e.desc))])]),a("vs-td",[a("p",[t._v(t._s(1==e.type?"官方":"主播"))])]),a("vs-td",[a("p",{staticStyle:{"white-space":"nowrap"}},[t._v(t._s(1==e.condition_type?"口令":2==e.condition_type?"充值":"口令+充值"))])]),a("vs-td",[a("p",{staticStyle:{"white-space":"nowrap"}},[t._v(t._s(e.run_lottery_time))])]),a("vs-td",[a("vs-chip",{staticClass:"product-order-status",attrs:{color:t.getOrderStatusColor(e.status)}},[t._v(t._s(t._f("title")(1==e.status?"未开奖":"已结束")))])],1),a("vs-td",[a("div",{staticClass:"opp",staticStyle:{display:"flex"}},[a("p",{on:{click:function(a){return t.detail(e.id)}}},[t._v("查看")]),a("p",{staticStyle:{"margin-left":"10px"},on:{click:function(a){return t.open(e.id)}}},[t._v("开奖")])])]),a("vs-td",[a("div",{staticClass:"opp",staticStyle:{display:"flex"}},[a("p",{on:{click:function(a){return t.del(e.id)}}},[t._v("删除")])])])],1)})),1)]}}]),model:{value:t.selected,callback:function(e){t.selected=e},expression:"selected"}},[a("template",{slot:"thead"},[a("vs-th",[t._v("房间主图")]),a("vs-th",{attrs:{"sort-key":"room_name"}},[t._v("房间标题")]),a("vs-th",{attrs:{"sort-key":"desc"}},[t._v("房间描述")]),a("vs-th",{attrs:{"sort-key":"condition_type"}},[t._v("参加方式")]),a("vs-th",{attrs:{"sort-key":"type"}},[t._v("类型")]),a("vs-th",{attrs:{"sort-key":"run_lottery_time"}},[t._v("开奖时间")]),a("vs-th",{attrs:{"sort-key":"status"}},[t._v("房间状态")]),a("vs-th",{attrs:{"sort-key":""}},[t._v("房间详情")]),a("vs-th",{attrs:{"sort-key":""}},[t._v("操作")])],1)],2),a("div",[a("vs-pagination",{attrs:{total:t.totalPages,max:7},model:{value:t.currentPage,callback:function(e){t.currentPage=e},expression:"currentPage"}})],1)],1)},i=[],s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("vs-sidebar",{staticClass:"add-new-data-sidebar items-no-padding",attrs:{"click-not-close":"","position-right":"",parent:"body","default-index":"1",color:"primary",spacer:""},model:{value:t.isSidebarActiveLocal,callback:function(e){t.isSidebarActiveLocal=e},expression:"isSidebarActiveLocal"}},[a("div",{staticClass:"mt-6 flex items-center justify-between px-6"},[a("h4",[t._v(t._s(0===Object.entries(this.data).length?"添加":"编辑")+" ROLL房间")]),a("feather-icon",{staticClass:"cursor-pointer",attrs:{icon:"XIcon"},on:{click:function(e){e.stopPropagation(),t.isSidebarActiveLocal=!1}}})],1),a("vs-divider",{staticClass:"mb-0"}),a(t.scrollbarTag,{key:t.$vs.rtl,tag:"component",staticClass:"scroll-area--data-list-add-new",attrs:{settings:t.settings}},[a("div",{staticClass:"p-6"},[t.dataImg?[a("div",{staticClass:"img-container w-64 mx-auto flex items-center justify-center"},[a("img",{staticClass:"responsive",attrs:{src:t.dataImg,alt:"img"}})]),a("div",{staticClass:"modify-img flex justify-between mt-5"},[a("input",{ref:"updateImgInput",staticClass:"hidden",attrs:{type:"file",accept:"image/*"},on:{change:t.updateCurrImg}}),a("vs-button",{staticClass:"mr-4",attrs:{type:"flat"},on:{click:function(e){return t.$refs.updateImgInput.click()}}},[t._v("上传图片")]),a("vs-button",{attrs:{type:"flat",color:"#999"},on:{click:function(e){t.dataImg=null}}},[t._v("删除图片")])],1)]:t._e(),t.dataImg?t._e():a("div",{staticClass:"upload-img mt-5"},[a("input",{ref:"uploadImgInput",staticClass:"hidden",attrs:{type:"file",accept:"image/*"},on:{change:t.updateCurrImg}}),a("vs-button",{on:{click:function(e){return t.$refs.uploadImgInput.click()}}},[t._v("上传图片")])],1),a("vs-input",{staticClass:"mt-5 w-full",attrs:{label:"房间名称"},model:{value:t.roomInfo.room_name,callback:function(e){t.$set(t.roomInfo,"room_name",e)},expression:"roomInfo.room_name"}}),a("vs-input",{staticClass:"mt-5 w-full",attrs:{label:"描述"},model:{value:t.roomInfo.desc,callback:function(e){t.$set(t.roomInfo,"desc",e)},expression:"roomInfo.desc"}}),a("vs-select",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],staticClass:"mt-5 w-full",attrs:{label:"类型",name:"item-category"},model:{value:t.roomInfo.type,callback:function(e){t.$set(t.roomInfo,"type",e)},expression:"roomInfo.type"}},t._l(t.roomInfoOption,(function(t){return a("vs-select-item",{key:t.value,attrs:{value:t.value,text:t.text}})})),1),a("vs-select",{directives:[{name:"validate",rawName:"v-validate",value:"required",expression:"'required'"}],staticClass:"mt-5 w-full",attrs:{label:"加入方式",name:"item-category"},model:{value:t.roomInfo.condition_type,callback:function(e){t.$set(t.roomInfo,"condition_type",e)},expression:"roomInfo.condition_type"}},t._l(t.conditionOption,(function(t){return a("vs-select-item",{key:t.value,attrs:{value:t.value,text:t.text}})})),1),1==t.roomInfo.condition_type?a("div",[a("vs-input",{staticClass:"mt-5 w-full",attrs:{label:"房间密码"},model:{value:t.roomInfo.password,callback:function(e){t.$set(t.roomInfo,"password",e)},expression:"roomInfo.password"}})],1):t._e(),2==t.roomInfo.condition_type?a("div",[a("vs-input",{staticClass:"mt-5 w-full",attrs:{label:"充值金额"},model:{value:t.roomInfo.condition_charge,callback:function(e){t.$set(t.roomInfo,"condition_charge",e)},expression:"roomInfo.condition_charge"}}),a("vs-input",{staticClass:"mt-5 w-full",attrs:{label:"充值开始时间",type:"datetime-local"},model:{value:t.roomInfo.condition_time,callback:function(e){t.$set(t.roomInfo,"condition_time",e)},expression:"roomInfo.condition_time"}})],1):t._e(),3==t.roomInfo.condition_type?a("div",[a("vs-input",{staticClass:"mt-5 w-full",attrs:{label:"房间密码"},model:{value:t.roomInfo.password,callback:function(e){t.$set(t.roomInfo,"password",e)},expression:"roomInfo.password"}}),a("vs-input",{staticClass:"mt-5 w-full",attrs:{label:"充值金额"},model:{value:t.roomInfo.condition_charge,callback:function(e){t.$set(t.roomInfo,"condition_charge",e)},expression:"roomInfo.condition_charge"}}),a("vs-input",{staticClass:"mt-5 w-full",attrs:{label:"充值开始时间",type:"datetime-local"},model:{value:t.roomInfo.condition_time,callback:function(e){t.$set(t.roomInfo,"condition_time",e)},expression:"roomInfo.condition_time"}})],1):t._e(),a("vs-input",{staticClass:"mt-5 w-full",attrs:{label:"开奖时间",type:"datetime-local"},model:{value:t.roomInfo.run_lottery_time,callback:function(e){t.$set(t.roomInfo,"run_lottery_time",e)},expression:"roomInfo.run_lottery_time"}})],2)]),a("div",{staticClass:"flex flex-wrap items-center p-6",attrs:{slot:"footer"},slot:"footer"},[a("vs-button",{staticClass:"mr-6",on:{click:t.submitData}},[t._v("提交")]),a("vs-button",{attrs:{type:"border",color:"danger"},on:{click:function(e){t.isSidebarActiveLocal=!1}}},[t._v("关闭")])],1)],1)},n=[],r=(a("3a23"),a("612f"),a("bd70"),a("f91a"),a("c322")),c=a.n(r),l={props:{isSidebarActive:{type:Boolean,required:!0},data:{type:Object,default:function(){}}},components:{VuePerfectScrollbar:c.a},data:function(){return{password:"",time:"",roomtitle:"",roomtext:"",roompirce:"",dataId:null,dataName:"",dataCategory:null,dataImg:null,dataOrder_status:"pending",dataPrice:0,settings:{maxScrollbarLength:60,wheelSpeed:.6},roomInfo:{},roomInfoOption:[{text:"官方",value:"1"},{text:"主播",value:"2"}],conditionOption:[{text:"口令",value:"1"},{text:"充值",value:"2"},{text:"口令 + 充值",value:"3"}],roomFile:""}},watch:{"roomInfo.condition_type":{handler:function(t){1==t?(this.roomInfo.condition_charge="",this.roomInfo.condition_time=""):2==t&&(this.roomInfo.password="")},deep:!0},isSidebarActive:function(t){if(!t)return this.roomInfo.condition_time=this.roomInfo.condition_time?this.roomInfo.condition_time.replace("T"," "):"",void(this.roomInfo.run_lottery_time=this.roomInfo.run_lottery_time?this.roomInfo.run_lottery_time.replace("T"," "):"");if(0===Object.entries(this.data).length)this.initValues(),this.$validator.reset();else{var e=JSON.parse(JSON.stringify(this.data)),a=(e.category,e.id),o=e.img,i=(e.name,e.order_status,e.price,e.condition_time),s=e.run_lottery_time;this.dataId=a,this.dataImg=o,this.roomInfo=this.data,this.roomInfo.condition_time=i?i.replace(" ","T"):"",this.roomInfo.run_lottery_time=s?s.replace(" ","T"):"",this.initValues()}}},computed:{isSidebarActiveLocal:{get:function(){return this.isSidebarActive},set:function(t){t||this.$emit("closeSidebar")}},isFormValid:function(){return!this.errors.any()&&this.dataName&&this.dataCategory&&this.dataPrice>0},scrollbarTag:function(){return this.$store.getters.scrollbarTag}},methods:{initValues:function(){if(!this.data.id)for(var t in this.roomInfo)this.roomInfo[t]=""},submitData:function(){var t=this,e=this,a=new FormData;a.append("data",JSON.stringify(e.roomInfo)),a.append("img_main",e.roomFile);var o="/admin/Free/createRoom";e.roomInfo.id>0&&(o="/admin/Free/editRoom"),e.$axios({url:o,method:"post",data:a,headers:{"Content-Type":"multipart/form-data"}}).then((function(e){console.log(e),1==e.data.status&&(t.$emit("closeSidebar"),t.$emit("get"),t.initValues())}))},updateCurrImg:function(t){var e=this;if(t.target.files&&t.target.files[0]){var a=new FileReader;a.onload=function(a){e.dataImg=a.target.result,e.roomFile=t.target.files[0]},a.readAsDataURL(t.target.files[0])}}}},d=l,u=(a("1dc4"),a("5d22")),m=Object(u["a"])(d,s,n,!1,null,"11782ae4",null),f=m.exports,p=a("ee31"),v={components:{DataViewSidebar:f},data:function(){return{selected:[],itemsPerPage:10,isMounted:!1,addNewDataSidebar:!1,sidebarData:{},data:[],url:"./room-component/NavMenu",free_room_id:"",currentPage:1,pageSize:10,totalPages:0,total:0}},computed:{},watch:{currentPage:{handler:function(t){this.getRoomList()}},queriedItems:{handler:function(t){}}},methods:{getRoomList:function(){var t=this;t.$axios({url:"/admin/Free/freeRoomList",method:"post",data:{page:t.currentPage,pageSize:t.pageSize}}).then((function(e){t.data=e.data.data.list,t.total=e.data.data.total,t.totalPages=t.pageTotal(t.total,t.pageSize)}))},pageTotal:function(t,e){return null==t||""==t?0:0!=e&&t%e==0?parseInt(t/e):0!=e&&t%e!=0?parseInt(t/e)+1:void 0},del:function(t){var e=this;e.free_room_id=t,this.$vs.dialog({type:"confirm",title:"提示",text:"确定删除？",accept:e.delRoom,cancel:e.cancel,acceptText:"确定",cancelText:"取消"})},delRoom:function(){var t=this;t.$axios({url:"/admin/Free/delRoom",method:"post",data:{id:t.free_room_id}}).then((function(e){1==e.data.status?(t.notify(e.data.msg,"success"),t.getRoomList()):t.notify(e.data.msg,"danger")}))},open:function(t){var e=this;e.free_room_id=t,this.$vs.dialog({type:"confirm",title:"提示",text:"确定操作开奖？",accept:e.sure,cancel:e.cancel,acceptText:"确定",cancelText:"取消"})},sure:function(t){var e=this;e.$axios({url:"/index/Free/getSkin",method:"post",data:{free_room_id:e.free_room_id}}).then((function(t){console.log(t),1==t.data.status?(e.getRoomList(),e.$vs.notify({title:"提示",text:t.data.msg,iconPack:"feather",icon:"icon-alert-circle",color:"success"})):e.$vs.notify({title:"提示",text:t.data.msg,iconPack:"feather",icon:"icon-alert-circle",color:"danger"})}))},notify:function(t,e){var a=this;a.$vs.notify({title:"提示",text:t,iconPack:"feather",icon:"icon-alert-circle",color:e})},addNewData:function(){this.sidebarData={},this.toggleDataSidebar(!0)},deleteData:function(t){this.$store.dispatch("dataList/removeItem",t).catch((function(t){console.error(t)}))},editNewData:function(t){this.sidebarData=t,this.toggleDataSidebar(!0)},detail:function(t){var e=this;console.log(t),e.$router.push({path:e.url,query:{id:t}})},getOrderStatusColor:function(t){return"1"==t?"success":"2"==t?"danger":"primary"},getPopularityColor:function(t){return t>90?"success":t>70?"primary":t>=50?"warning":t<50?"danger":"primary"},toggleDataSidebar:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.addNewDataSidebar=t}},created:function(){p["a"].isRegistered||(this.$store.registerModule("dataList",p["a"]),p["a"].isRegistered=!0),this.$store.dispatch("dataList/fetchDataListItems")},mounted:function(){this.isMounted=!0,this.getRoomList()}},g=v,h=(a("5787"),Object(u["a"])(g,o,i,!1,null,null,null));e["default"]=h.exports},ee31:function(t,e,a){"use strict";var o={products:[]},i=(a("a1d1"),{ADD_ITEM:function(t,e){t.products.unshift(e)},SET_PRODUCTS:function(t,e){t.products=e},UPDATE_PRODUCT:function(t,e){var a=t.products.findIndex((function(t){return t.id===e.id}));Object.assign(t.products[a],e)},REMOVE_ITEM:function(t,e){var a=t.products.findIndex((function(t){return t.id===e}));t.products.splice(a,1)}}),s=a("bb36"),n={addItem:function(t,e){var a=t.commit;return new Promise((function(t,o){s["a"].post("/api/data-list/products/",{item:e}).then((function(o){a("ADD_ITEM",Object.assign(e,{id:o.data.id})),t(o)})).catch((function(t){o(t)}))}))},fetchDataListItems:function(t){var e=t.commit;return new Promise((function(t,a){s["a"].get("/api/data-list/products").then((function(a){e("SET_PRODUCTS",a.data),t(a)})).catch((function(t){a(t)}))}))},updateItem:function(t,e){var a=t.commit;return new Promise((function(t,o){s["a"].post("/api/data-list/products/".concat(e.id),{item:e}).then((function(e){a("UPDATE_PRODUCT",e.data),t(e)})).catch((function(t){o(t)}))}))},removeItem:function(t,e){var a=t.commit;return new Promise((function(t,o){s["a"].delete("/api/data-list/products/".concat(e)).then((function(o){a("REMOVE_ITEM",e),t(o)})).catch((function(t){o(t)}))}))}},r={};e["a"]={isRegistered:!1,namespaced:!0,state:o,mutations:i,actions:n,getters:r}}}]);
//# sourceMappingURL=chunk-74c62971.de7fa5cd.js.map