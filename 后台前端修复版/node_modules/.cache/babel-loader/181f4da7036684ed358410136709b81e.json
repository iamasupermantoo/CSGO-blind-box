{"remainingRequest":"D:\\Program Files (x86)\\wechat\\WeChat Files\\wxid_ue0ca48wn2m522\\FileStorage\\File\\2022-09\\盲盒源码\\后台前端\\node_modules\\babel-loader\\lib\\index.js!D:\\Program Files (x86)\\wechat\\WeChat Files\\wxid_ue0ca48wn2m522\\FileStorage\\File\\2022-09\\盲盒源码\\后台前端\\src\\fake-db\\data\\user\\index.js","dependencies":[{"path":"D:\\Program Files (x86)\\wechat\\WeChat Files\\wxid_ue0ca48wn2m522\\FileStorage\\File\\2022-09\\盲盒源码\\后台前端\\src\\fake-db\\data\\user\\index.js","mtime":1620826038000},{"path":"D:\\Program Files (x86)\\wechat\\WeChat Files\\wxid_ue0ca48wn2m522\\FileStorage\\File\\2022-09\\盲盒源码\\后台前端\\babel.config.js","mtime":1620826038000},{"path":"D:\\Program Files (x86)\\wechat\\WeChat Files\\wxid_ue0ca48wn2m522\\FileStorage\\File\\2022-09\\盲盒源码\\后台前端\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\Program Files (x86)\\wechat\\WeChat Files\\wxid_ue0ca48wn2m522\\FileStorage\\File\\2022-09\\盲盒源码\\后台前端\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.array.find\";\nimport mock from '@/fake-db/mock.js';\nimport jwt from 'jsonwebtoken';\nvar data = {\n  checkpointReward: {\n    userName: 'John',\n    progress: '57.6%'\n  },\n  users: [{\n    uid: 34,\n    displayName: 'Howard Potts',\n    password: 'adminadmin',\n    photoURL: require('@/assets/images/portrait/small/avatar-s-5.jpg'),\n    email: 'admin@admin.com',\n    phoneNumber: null\n  }]\n};\nvar jwtConfig = {\n  'secret': 'dd5f3089-40c3-403d-af14-d0c228b05cb4',\n  'expireTime': 8000\n};\nmock.onPost('/api/auth/login').reply(function (request) {\n  var _JSON$parse = JSON.parse(request.data),\n      email = _JSON$parse.email,\n      password = _JSON$parse.password;\n\n  var error = 'Something went wrong';\n  var user = data.users.find(function (user) {\n    return user.email === email && user.password === password;\n  });\n\n  if (user) {\n    try {\n      var accessToken = jwt.sign({\n        id: user.uid\n      }, jwtConfig.secret, {\n        expiresIn: jwtConfig.expireTime\n      });\n      var userData = Object.assign({}, user, {\n        providerId: 'jwt'\n      });\n      delete userData.password;\n      var response = {\n        userData: userData,\n        accessToken: accessToken\n      };\n      return [200, response];\n    } catch (e) {\n      error = e;\n    }\n  } else {\n    error = 'Email Or Password Invalid';\n  }\n\n  return [200, {\n    error: error\n  }];\n});\nmock.onPost('/api/auth/register').reply(function (request) {\n  var _JSON$parse2 = JSON.parse(request.data),\n      displayName = _JSON$parse2.displayName,\n      email = _JSON$parse2.email,\n      password = _JSON$parse2.password;\n\n  var isEmailAlreadyInUse = data.users.find(function (user) {\n    return user.email === email;\n  });\n  var error = {\n    email: isEmailAlreadyInUse ? 'This email is already in use.' : null,\n    displayName: displayName === '' ? 'Please enter your name.' : null\n  };\n\n  if (!error.displayName && !error.email) {\n    var userData = {\n      email: email,\n      password: password,\n      displayName: displayName,\n      photoURL: require('@/assets/images/portrait/small/avatar-s-5.jpg'),\n      phoneNumber: null\n    }; // Add user id\n\n    var length = data.users.length;\n    var lastIndex = 0;\n\n    if (length) {\n      lastIndex = data.users[length - 1].uid;\n    }\n\n    userData.uid = lastIndex + 1;\n    data.users.push(userData);\n    var accessToken = jwt.sign({\n      id: userData.uid\n    }, jwtConfig.secret, {\n      expiresIn: jwtConfig.expireTime\n    });\n    var user = Object.assign({}, userData);\n    delete user['password'];\n    var response = {\n      userData: user,\n      accessToken: accessToken\n    };\n    return [200, response];\n  } else {\n    return [200, {\n      error: error\n    }];\n  }\n});\nmock.onPost('/api/auth/refresh-token').reply(function (request) {\n  var _JSON$parse3 = JSON.parse(request.data),\n      accessToken = _JSON$parse3.accessToken;\n\n  try {\n    var _jwt$verify = jwt.verify(accessToken, jwtConfig.secret),\n        id = _jwt$verify.id;\n\n    var userData = Object.assign({}, data.users.find(function (user) {\n      return user.uid === id;\n    }));\n    var newAccessToken = jwt.sign({\n      id: userData.uid\n    }, jwtConfig.secret, {\n      expiresIn: jwtConfig.expiresIn\n    });\n    delete userData['password'];\n    var response = {\n      userData: userData,\n      accessToken: newAccessToken\n    };\n    return [200, response];\n  } catch (e) {\n    var error = 'Invalid access token';\n    return [401, {\n      error: error\n    }];\n  }\n});\nmock.onGet('/api/user/checkpoint-reward').reply(function () {\n  return [200, data.checkpointReward];\n});",{"version":3,"sources":["D:/Program Files (x86)/wechat/WeChat Files/wxid_ue0ca48wn2m522/FileStorage/File/2022-09/盲盒源码/后台前端/src/fake-db/data/user/index.js"],"names":["mock","jwt","data","checkpointReward","userName","progress","users","uid","displayName","password","photoURL","require","email","phoneNumber","jwtConfig","onPost","reply","request","JSON","parse","error","user","find","accessToken","sign","id","secret","expiresIn","expireTime","userData","Object","assign","providerId","response","e","isEmailAlreadyInUse","length","lastIndex","push","verify","newAccessToken","onGet"],"mappings":"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","sourcesContent":["import mock from '@/fake-db/mock.js'\r\nimport jwt from 'jsonwebtoken'\r\n\r\nconst data = {\r\n  checkpointReward: {\r\n    userName: 'John',\r\n    progress: '57.6%'\r\n  },\r\n  users: [\r\n    {\r\n      uid: 34,\r\n      displayName: 'Howard Potts',\r\n      password: 'adminadmin',\r\n      photoURL: require('@/assets/images/portrait/small/avatar-s-5.jpg'),\r\n      email: 'admin@admin.com',\r\n      phoneNumber: null\r\n    }\r\n  ]\r\n}\r\n\r\n\r\nconst jwtConfig = {\r\n  'secret'   : 'dd5f3089-40c3-403d-af14-d0c228b05cb4',\r\n  'expireTime': 8000\r\n}\r\n\r\n\r\nmock.onPost('/api/auth/login').reply((request) => {\r\n  const {email, password} = JSON.parse(request.data)\r\n\r\n  let error = 'Something went wrong'\r\n\r\n  const user = data.users.find(user => user.email === email && user.password === password)\r\n\r\n  if (user) {\r\n\r\n    try {\r\n\r\n      const accessToken = jwt.sign({id: user.uid}, jwtConfig.secret, {expiresIn: jwtConfig.expireTime})\r\n\r\n      const userData = Object.assign({}, user, {providerId: 'jwt'})\r\n\r\n      delete userData.password\r\n\r\n      const response = {\r\n        userData,\r\n        accessToken\r\n      }\r\n\r\n      return [200, response]\r\n\r\n    } catch (e) {\r\n      error = e\r\n    }\r\n  } else {\r\n    error = 'Email Or Password Invalid'\r\n  }\r\n\r\n  return [200, {error}]\r\n\r\n\r\n})\r\n\r\nmock.onPost('/api/auth/register').reply((request) => {\r\n  const {displayName, email, password} = JSON.parse(request.data)\r\n  const isEmailAlreadyInUse = data.users.find((user) => user.email === email)\r\n  const error = {\r\n    email      : isEmailAlreadyInUse ? 'This email is already in use.' : null,\r\n    displayName: displayName === '' ? 'Please enter your name.' : null\r\n  }\r\n\r\n  if (!error.displayName && !error.email) {\r\n\r\n    const userData = {\r\n      email,\r\n      password,\r\n      displayName,\r\n      photoURL: require('@/assets/images/portrait/small/avatar-s-5.jpg'),\r\n      phoneNumber: null\r\n    }\r\n\r\n    // Add user id\r\n    const length = data.users.length\r\n    let lastIndex = 0\r\n    if (length) {\r\n      lastIndex = data.users[length - 1].uid\r\n    }\r\n    userData.uid = lastIndex + 1\r\n\r\n    data.users.push(userData)\r\n\r\n    const accessToken = jwt.sign({id: userData.uid}, jwtConfig.secret, {expiresIn: jwtConfig.expireTime})\r\n\r\n    const user = Object.assign({}, userData)\r\n    delete user['password']\r\n    const response = {\r\n      userData: user,\r\n      accessToken\r\n    }\r\n\r\n    return [200, response]\r\n  } else {\r\n    return [200, {error}]\r\n  }\r\n})\r\n\r\n\r\nmock.onPost('/api/auth/refresh-token').reply((request) => {\r\n\r\n  const {accessToken} = JSON.parse(request.data)\r\n\r\n  try {\r\n    const {id} = jwt.verify(accessToken, jwtConfig.secret)\r\n\r\n    const userData = Object.assign({}, data.users.find(user => user.uid === id))\r\n\r\n    const newAccessToken = jwt.sign({id: userData.uid}, jwtConfig.secret, {expiresIn: jwtConfig.expiresIn})\r\n\r\n    delete userData['password']\r\n    const response = {\r\n      userData,\r\n      accessToken: newAccessToken\r\n    }\r\n\r\n    return [200, response]\r\n  } catch (e) {\r\n    const error = 'Invalid access token'\r\n    return [401, {error}]\r\n  }\r\n})\r\n\r\n\r\nmock.onGet('/api/user/checkpoint-reward').reply(() => {\r\n  return [200, data.checkpointReward]\r\n})\r\n"]}]}